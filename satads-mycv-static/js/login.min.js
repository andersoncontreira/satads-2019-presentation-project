/*!
 * Start Bootstrap - SATADS MyCv Auth v5.0.4 (https://startbootstrap.com/template-overviews/resume)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-resume/blob/master/LICENSE)
 */

!function(){var r=window.location.host.match(/localhost/)?"http://localhost:2000/satads":"https://services.hagatus.com.br/satads",t=/^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.[a-zA-Z]{2,}(\.[a-zA-Z]{2,3})?$/;new Vue({el:"#login",data:{email:null,password:null,repeatPassword:null,firstName:null,lastName:null,errorMessage:"",showSignInClass:!0,showSignUpClass:!1},created:function(){console.log("created"),sessionStorage.clear()},methods:{validateSignIn:function(){var e=!0;return t.exec(this.email)||(e=!1,this.errorMessage="Invalid Email Address"),e},validateSignUp:function(){var e=!0;return""!==this.firstName&&null!==this.firstName||(e=!1,this.errorMessage="First name empty"),!e||""!==this.lastName&&null!==this.lastName||(e=!1,this.errorMessage="Last name empty"),e&&!t.exec(this.email)&&(e=!1,this.errorMessage="Invalid Email Address"),e&&this.password!==this.repeatPassword&&(e=!1,this.errorMessage="Passwords not match"),e},showSignInForm:function(){console.log("show Sign In"),this.showSignInClass=!0,this.showSignUpClass=!1},showSignUpForm:function(){console.log("show Sign Up"),this.showSignInClass=!1,this.showSignUpClass=!0},validateResponseData:function(e,t){return-1<[200,201].indexOf(e.status)&&t.hasOwnProperty("data")&&t.data!=={}},signIn:function(e){e&&e.preventDefault();var o=this,t={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:this.email,password:this.password})};this.validateSignIn()?fetch(r+"/auth/v1/signin",t).then(function(r){r.text().then(function(e){var t=e&&JSON.parse(e),s=t&&t.message||r.statusText;r.ok?o.validateResponseData(r,t)?(console.log("success",t.data),sessionStorage.setItem("person",JSON.stringify(t.data)),Swal.fire({type:"success",title:"SignIn Success",text:"Redirecting...",showConfirmButton:!1,timer:2e3}).then(function(){window.location.href="/mycv.html"})):(console.log("error",s),console.log("data",t),Swal.fire({type:"error",title:"SignIn Error",text:s})):(console.log("error",t),Swal.fire({type:"error",title:"SignIn Error",text:s}))})}).catch(function(e){console.error(e);Swal.fire({type:"error",title:"SignIn Error",text:"Service Unavailable"})}):Swal.fire({type:"error",title:"SignIn Error",text:this.errorMessage})},signUp:function(e){e&&e.preventDefault();var o=this;if(this.validateSignUp()){var t={firstName:this.firstName,lastName:this.lastName,email:this.email,password:this.password,gid:null,imageUrl:null},s={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(t)};fetch(r+"/auth/v1/signup",s).then(function(r){console.log(r),r.text().then(function(e){var t=e&&JSON.parse(e),s=t&&t.message||r.statusText;console.log(t),r.ok?o.validateResponseData(r,t)?(console.log("success",t.data),sessionStorage.setItem("person",JSON.stringify(t.data)),sessionStorage.setItem("welcome",!0),Swal.fire({type:"success",title:"SignUp Success",text:"Redirecting...",showConfirmButton:!1,timer:2e3}).then(function(){window.location.href="/mycv.html"})):(console.log("error",s),console.log("data",t),Swal.fire({type:"error",title:"SignIn Error",text:s})):(console.log("error",t),Swal.fire({type:"error",title:"SignIn Error",text:s}))})}).catch(function(e){console.error(e);Swal.fire({type:"error",title:"SignIn Error",text:"Service Unavailable"})})}else Swal.fire({type:"error",title:"SignUp Error",text:this.errorMessage})}}})}();